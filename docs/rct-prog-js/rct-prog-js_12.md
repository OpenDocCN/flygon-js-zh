# 第十二章。一切如何契合

谷歌地图在推出时非常受欢迎，它仍然非常重要，但它引入的新功能几乎没有什么。谷歌在地图网站上的贡献是将以前只能通过陡峭的学习曲线获得的东西变得简单易用。这已经是相当了不起的了。

关于 ReactJS 也可以说类似的事情。Facebook 没有发明函数式响应式编程。Facebook 似乎也没有显著扩展函数式响应式编程。但是 ReactJS 显著降低了门槛。以前，对于函数式响应式编程，经验丰富的 C++程序员经常会说：“我想我可能只是愚蠢，或者至少，我没有计算数学博士学位。”也许可以说精通 C++并不是一件小事；在 Python 中让某些东西工作比在 C++中让相同的东西工作要容易得多，就像在当地公园的冬季滑雪山坡上滑雪比攀登珠穆朗玛峰要容易得多一样。此外，ReactJS 引入了足够的变化，以至于没有任何数学、计算或其他方面的学位的合格 C++程序员有很大机会使用 ReactJS 并且在其中高效工作。也许他们可能没有纯 JavaScript 程序员对函数式编程特别感兴趣的那么有效。但是学会有效地编程 C++是一个*真正*的成就，大多数优秀的 C++程序员有很大机会有用地实现 ReactJS 中的函数式响应式编程。然而，对于阅读维基百科上的计算机数学论文并在学术作者通常偏爱的 Haskell 语言中实现某些东西，就不能说同样的话了。

在这个结论中，我们将探讨本章中的以下主题：

+   回顾所涵盖的领域

+   免疫于引发《人月神话》的问题。

+   ReactJS 只是一个视图，但是是一个很棒的视图！

+   编程 ReactJS 的乐趣

+   ReactJS 开启了全新的视野，超越了网络。这里介绍的 ReactJS 工作并不是 ReactJS 可能性的*终点*：它只是*开始*。

# 回顾所涵盖的领域

在这本书中，我们在理论和实践上都涵盖了很多内容。我们涵盖了函数式编程、响应式编程和函数式响应式编程的基础知识。我们还介绍了 Facebook 的 ReactJS 技术。它使一些函数式响应式编程的优势可以用于前端开发人员，而这些开发人员不一定精通计算数学（不幸的是，这在本文中是一个显著的特点）。这里的文本旨在跟随 ReactJS 的步伐，特别是为了让没有特殊数学背景的程序员能够理解。在这个过程中，我们遇到了一些有趣的技术，比如 Om、Brython 和 Jest，并且看了一下未来前端 Web 开发可能会是什么样子。我们可能可以使用我们选择的语言进行 Web 开发，而不一定局限于 JavaScript。

我们还构建了两个系统，一个较小，一个较大，并尝试演示解决问题的轻微变化：使用或不使用 JSX，对表单元素使用受控值，以及通过经典的表单 Hijaxing。重点不完全在于哪一个比另一个更好，因为需求会需要不同的解决方案，我们希望至少覆盖的方法中的一种在特定情况下是有帮助的。

在这个过程中，有理由说，就像有人说关于 Python 一样，“编程再次变得有趣！”每个系统都有其怪癖，但不知何故，使用 ReactJS 时似乎在道路上遇到的障碍要少一些。本书对 CKeditor 的简要介绍必然包括了一个解决方案，以解决首次使用 CKeditor 的用户可能遇到的障碍。关于 ReactJS 代码中持续存在的问题的解决方案几乎没有必要的警告。

# 神话般的程序员月份是否可以避免？

弗雷德·布鲁克斯于 1975 年出版的《神话般的程序员月份》（在您阅读本书时已经超过 40 年）是软件工程文献中引用最多的作品。塔南鲍姆的经典教科书《操作系统：设计与实现》提到了布鲁克斯的书名：

> “OS/360 的设计者之一弗雷德·布鲁克斯写了一本风趣而深刻的书（布鲁克斯，1975 年），描述了他在 OS/360 项目中的经历。虽然在这里总结这本书是不可能的，但可以说封面上显示了一群史前动物陷入了沥青坑……”

在这里，有直接的相关性。为了解释这一点，让我们制作史蒂夫·卢施尔引入的 Big-Coffee 符号的变体。也许除了卢施尔本人之外，没有人知道是什么启发他以他的方式表达观点，但卢施尔显然熟悉运行时复杂性的经典大 O 符号，可能也知道它也用于评估其他资源使用方面的复杂性，比如内存。但我可能会建议，组织沟通复杂性可能需要额外的启发，就像 Big Organization 复杂性所解释的那样。如果 Big-Coffee 复杂性可能是夜梦般的二次方，或者正如卢施尔所写的那样，那么在单片项目内部的沟通复杂性中会出现一些令人不安的熟悉现象。

如果一个单片项目上有一个程序员，那么复杂性为零，因为不需要避免踩到其他程序员的脚。如果有两个程序员，那么沟通的复杂性就是一个连接。如果有三个程序员，就有三个连接；如果扩展到 10 个程序员，文件工作量就会扩大到 45 个连接。IBM 对 OS/360 项目的方法是所谓的大蓝色解决方案，它说：“因为我们想要完成很多工作，所以让我们雇用很多很多程序员！”IBM 拥有超过 10 名程序员，因此连接数量远远超过 45 个。

一个可能适合表示组织沟通复杂性的字符是互连的 HTML dingbat，可编码为`&#9784;`或`&#x2638;`：

![神话般的程序员月份是否可以避免？](img/B04108_12_02.jpg)

如果我们能够将“大组织”复杂性的沟通需求量化，以防止程序员破坏其他人的工作，也许没有任何特殊符号是完美的。但我们可以说，单片软件项目具有二次沟通复杂性——![神话般的程序员月份是否可以避免？](img/B04108_12_03.jpg)，或者如果您愿意的话，![神话般的程序员月份是否可以避免？](img/B04108_12_04.jpg)——开发人员需要跟上其他变化，并部分避免与其他开发人员的工作发生冲突。在 OS/360 项目的规模上，这导致开发人员花费超过一半的时间只是为了跟上备忘录，以了解其他程序员所做的工作。

有理由相信，如果 OS/360 项目采用了 Facebook 用于 ReactJS 加 Flux 的方法，可能就不需要写《神话般的程序员月份》了。

ReactJS 和 Flux 的组合明确写成，这样你就不需要在每个组件的口袋里动手脚。事实上，它是这样写的，如果每个人都遵循这种方法，你就不能在其他组件的口袋里动手脚，除非你找到一种突破安全的方法。通信复杂度不是二次的（就像 OS/360 项目中那样），如果每个组件最多只有一个开发人员，通信方向的数量要小得多，可能仅略高于线性。这种差异在其影响方面是巨大的。

尽管 Facebook 是否坚持纯粹主义以实现理论上可能的最佳结果尚不清楚，但似乎显而易见的是，Facebook——这是互联网上最大的组织之一，可能拥有与 OS/360 项目规模相当或更大的前端开发人员——其通信比单一的 OS/360 努力要好得多。也许 Facebook 是众多更愿意宣传自己的优势而不是弱点的组织之一。但我在网上找到的任何资源都没有表明 Facebook 开发人员之间的沟通量超出了控制，就像 OS/360 项目中那样，或者必要的内部沟通量足够多到足以成为使开发人员的生活变得真正困难的问题。

# ReactJS 只是一个视图，但是多么美丽的视图！

塞尚曾经说过：“莫奈只是一只眼睛，但是多么美丽的眼睛！”莫奈并没有试图炫耀他对结构和解剖学的知识，而是只是复制他的眼睛所看到的。对他的作品的共识判断坚持着“只是一只眼睛”和“多么美丽的眼睛！”事实上，在莫奈的作品中，细节可能不太清晰，他反对试图用深奥的解剖学知识和远远超出眼睛所看到的结构的知识来给人留下深刻印象的艺术。

ReactJS 是一个框架，而不是一个库，这意味着你应该在 ReactJS 提供的结构内构建解决方案，而不是将 ReactJS 插入你自己设计的解决方案中。库的典型例子是 jQuery，你可以按照自己的方式构建解决方案，并在需要时调用 jQuery。

然而，ReactJS 专门用作视图。这并不一定是好事或坏事，但 ReactJS 并不是一个完整的 Web 开发框架，也没有成为你永远需要的唯一工具的意图。它专注于成为一个视图，在 Facebook 的提供中，这并不包括任何形式的 AJAX 调用。这并不是在开发 ReactJS 时犯下的重大疏忽；预期是你使用 ReactJS 作为视图来提供用户界面功能，并使用其他工具来满足其他需要。本文没有涵盖使用 ReactJS 与你喜欢的工具一起使用，但如果它们不会互相冲突，就将你喜欢的工具与 ReactJS 结合使用。ReactJS 可能会与其他视图发生冲突，但它的目的是与非视图技术一起工作。

# 编程又变得有趣起来了！

当互联网首次出现时，我有了第一次“编程又变得有趣了！”的体验。我在 Unix 和 C 编程中找到了我的方向，当我得知在网页中包含图像是可能的时，我预计在类似 C 的环境中从头开始告诉如何显示图像需要多少工作。我内心认为，“对我来说太多工作了。” 但我惊讶地发现，一个图像可以在网页中包含，只需要`<IMG SRC=Portrait.GIF>`，图像本身不需要嵌入在网页中；它同样可以优雅地作为`<A HREF=Portrait.GIF>点击这里！</A>`提供。这是我第一次接触到一种声明性而不是命令式的语言。也许它严格来说不是编程；当然，在 JavaScript 出现之前，它不是图灵近似。然而，它让我轻松地做了一些我以前无法想象的电脑工作。

几年后，我第二次体验到“编程又变得有趣了！”是在一个朋友建议我尝试 Python 之后。那时，我已经成为了一名语言收藏家；我想要了解的唯一语言是 Icon、C++和一些汇编语言。语言收藏家的一个普遍现实是，他们在新语言中的第一个项目比任何后续工作都要慢、更困难、更令人沮丧。之后会好一些，但对于第一个项目来说，“它总是比你想象的时间长，即使你考虑到了它总是比你想象的时间长这个事实。”然而，用 Python 时，我惊讶地发现，“什么？*它已经在运行了*？”这只是冰山一角。

我作为一名语言收藏家，发现 Python，然后停止学习新语言的经历并不是 Pythoneers 中特别不寻常的故事。埃里克·雷蒙德在他的文章《为什么选择 Python？》中提到了一些更深层次的东西，网址是[`www.linuxjournal.com/article/3882`](http://www.linuxjournal.com/article/3882)。Python 是一个充满魔力的王国，街道都是用胶水铺成的，不仅仅是大师们才能受益。

之前没有提到的是，如果你将鼠标悬停在[`xkcd.com/353/`](http://xkcd.com/353/)的卡通图片上，会出现这样的消息：**昨天我用 Python 写了 20 个简短的程序。太棒了。Perl，我要离开你了……** 现在 Perl 也是一种很好的语言，曾经是我的最爱，但 Python 仍然有着独特的魅力。

最后，我最后一次也是最伟大的“编程又变得有趣了！”时刻是当我开始欣赏 ReactJS 时。在创建可以像标签一样使用的有用组件方面，ReactJS 提供了 XHTML 和 HTML5 所没有的东西。

无论 XHTML 中的“X”代表什么，它并不意味着“在主流使用中，人们会构建和部署大量有趣的新标签”。HTML5 提供了许多新组件，比如`<input type="date" />`，但它们并不被普遍支持，这并不是 IE 必须成为派对的灵魂的另一个案例。主流和当前的非微软浏览器对 HTML5 在聚光灯下宣布的功能的覆盖范围非常不一致。有一些 polyfills 可用，并且整合在 HTML5 之前存在的许多 JavaScript 日期选择器可能在今天和它们刚出现时一样有意义。但是，像[`html5please.com/`](http://html5please.com/)这样的网站值得赞扬和使用，但它也是一个主要问题的症状。

ReactJS 和 JSX 成功地解决了这些问题。本文没有涵盖如何制作`<DatePicker />`函数，但一旦制作完成，你可以将它几乎像原生 HTML 标签一样包含在你的 JSX 中。如果有人对分形感到怀旧，绘制在 HTML5 画布上并制作可滚动和可缩放的`<LogisticMap />`、`<VonKochSnowflake />`、`<MandelbrotSet />`和`<SierpinskiGasket />`，这些可以像普通的简单的`<img />`标签一样容易地包含在 JSX 中。在 ReactJS 中定义的组件在一个重要的意义上不同于手动配置和连接 JavaScript 日期选择器以使其与你的表单一起工作。它们就像经典结构化编程中的子程序，可以在有意义的地方方便地重复使用，并组合成更大的构建块。

### 提示

可能会有人建议，制作一些有用组件的库，这些组件可以用来扩展其他网页开发人员可以使用的基本有用标签集。

此外，如果我可以借用 Robin Martin 的“什么杀死了 Smalltalk 可能会杀死 Ruby”并使用更礼貌的语言，代码审查中的关键指标（以及其他指标）是审查人员不得不问“他们在想什么？”的次数。对于正在审查的代码来说，“他们在想什么？”的指标，得分为 0 是可以接受的。任何高于此分数的都是不可接受的。此外，这个指标在代码审查之外也是相关的。

在 Python 中，这样的时刻是罕见的：它们确实存在，搜索“Python 可变默认参数”将显示出来，但它们之所以重要是因为它们罕见。这与 JavaScript 中的“他们在想什么？”的争论不同，比如“你可以使用未声明的变量（但如果你这样做，它们将是全局的）”和“你可以编写伪经典构造函数（但如果你在调用它们时忘记使用 new 关键字，它们将在全局命名空间中破坏东西）”。JavaScript 的环境是这样的，以至于像 Douglas Crockford 这样的关键语言倡导者，严厉警告人们远离基本语言的大部分内容，并且似乎随着时间的推移变得更加挑剔。

最终，ReactJS 和 Python 似乎有着相同的核心。两者都是本质上小而简单的。也许两者都有缺陷，但缺陷是“他们在想什么？”的时刻是个例外而不是常态。正如在 ReactJS 宣布时所说的那样，有一条讽刺的推文说：“Facebook：重新思考已经确立的最佳实践。”ESR 对 Python 奇怪的选择使用显著的空格表示有些困扰。

> *“就像大多数黑客一样，当意识到这一事实时，我本能地感到厌恶。”*
> 
> *我当时还不够老，只是在 20 世纪 70 年代的几个月里编写了一些批处理 Fortran 程序。如今，大多数黑客都不是，但不知何故，我们的文化似乎保留了对那些旧式固定字段语言有多么讨厌的相当准确的民间记忆。事实上，当时用来描述 Pascal 和 C 中较新的基于标记的语法的术语“自由格式”几乎已经被遗忘。所有语言现在都已经设计成这样了，或者几乎都是；无论如何。看到这个 Python 特性，很难责怪任何人最初的反应好像他们意外地踩到了一堆恐龙粪便。”* 

ReactJS 也有勇气说，那些创建 CSS 的人可以创建非常简单的 JavaScript，而不仅仅是在故意设计不足的模板语言中工作。现在，JavaScript 被选择为一种特定领域的语言，以故意留下尽可能多的功能。但设计师并不需要召唤 JavaScript 的全部功能。他们可以创建 99%的简单 JavaScript，这在故意设计不足的模板语言中已经完成了，而 JavaScript 开发人员可以创建剩下的 1%的强大 JavaScript，因为在故意设计不足的模板语言中解决这个问题会很棘手。

# 总结

在这一章中，我们看了一些比较高层次的东西。其他章节详细介绍了一些项目，但在这里，我们看了一些 ReactJS 代表的主要优势，以及一些计算机领域中最著名的问题。

这本书旨在涵盖 Facebook 的 ReactJS 的功能性响应式编程的理论和实践。这并不是第一本涵盖功能性编程、响应式编程或功能性响应式编程的书，但它可能是功能性响应式编程的早期著作之一，不假设博士级别的数学能力。其中一部分是通过使文本有些哲学性来实现的。在某种意义上，这是为了让一些资深程序员更容易理解，但对大多数资深程序员来说并不是不可能理解的。JavaScript 和 ReactJS 中最好的功能性响应式编程基于功能性编程的熟练度，而 Haskell 中最好的功能性响应式编程也是基于功能性编程的熟练度；在这方面没有真正的区别。然而，一个典型的资深 C++程序员有很大机会在 ReactJS 中获得有用的熟练度。Facebook 在让事情更容易接触方面做得相当出色。

JavaScript 是一种多才多艺的语言，如果你以 Scheme 方式（当然！）或 Python 方式、C＃、Erlang、Perl、Ruby、Java、Haskell、PHP、Lisp 或 Visual Basic 的方式来思考，你可以获得相当大的生产力。也许没有其他编程语言的思维方式会达到纯粹、功能驱动的 JavaScript 思维的最高层次，但在 JavaScript 中你可以表达很多东西，而不需要成为一个母语为 JavaScript 的人，拥有完美的 JavaScript 口音！

在 ReactJS 中没有失去任何东西。也许在功能性响应式编程中，除非你在某些非常特定的数学领域有很高的熟练度，否则最后一丝力量无法被挤出来，但 ReactJS 显著降低了功能性响应式编程的门槛。功能性响应式编程过去在门口上有一个无声的标志，上面写着“只有数学编程高手才能进入”。现在没有了。掌握功能性响应式编程可能纯粹是为了在 ReactJS 中工作有优势，但所有其他提到的专业领域都可以在 ReactJS 中获得很多好处，而不需要了解太多数学，只需要了解通常嵌入在计算机科学和信息技术中的重要熟练度。

有人说开发人员很少为*书籍*付费；他们为*章节*付费。这本书旨在作为一个整体运作，不同的部分展示了互补的方法，以便每个部分都为整体增添内容。但它也严肃地旨在提供可以作为独立资产完美运作的章节，以便那些想要对某些东西进行定位的人使用。

## 从这里开始的下一步

你可以探索无数的方向。你可以深入挖掘并探索 ReactJS 的核心。你也可以探索将 ReactJS 集成到使用其他技术解决其他问题的项目中。

然后，你可以用 Lisp 或 Python 来编写 ReactJS。（不仅仅是真实的，如果你来自“Lispy”或“Pythonic”的背景，你才能用 JavaScript 编写 ReactJS。你可以使用 Lisp 或 Python 创建动画网页，而不需要离开 Lisp 或 Python 来编写一行 JavaScript 代码。）

你可以创建比 HTML5 的任何版本都更丰富的组件，并且可以像 HTML 1.0 提供的组件一样轻松地使用它们。

也许最令人兴奋的可能性是，ReactJS 不再仅适用于 HTML/Web。它现在为“一次学习，随处编写”提供了一个杀手级应用程序。现在你出色的 JavaScript 技能和学习函数式编程的努力不仅可以在 Web 上使用，而且可以轻松地为 iOS 编写。现在请查看[`facebook.github.io/react-native/`](https://facebook.github.io/react-native/)的主页。这本书让你不仅可以在 Web 上使用 ReactJS，还可以快速而且很好地学习 ReactJS Native，这是非常重要的。

*你已经爬到了跳板的顶端。现在是时候跳下去，制造最大的水花了。*

也许关于如何使用函数式响应式编程和 ReactJS 的最好方法是根本不要*使用*ReactJS。而是*玩*ReactJS，就像你玩新鲜的雪一样。关于格拉斯哥哈斯克尔编译器所说的话完全适用于 ReactJS：忘记它是你用来工作的东西。像一个年幼的孩子一样玩它。看看你能建造什么，以及你不能建造什么。

编程又是新的；有了魔法。就像程序员曾经获得了使用与内置函数同等的程序员贡献的子程序的能力一样，现在前端 Web 开发人员已经获得了使用开发人员制作的组件的能力，就像在他们的 JSX 中包含`IMG`标签一样容易且没有麻烦。过去我们需要去[`html5please.com/`](http://html5please.com/)学习`<input type="date">`有一个“警告[甚至]使用 polyfill 时要小心”的琥珀警告标签。过去你甚至需要手动在每个页面上连接 JavaScript 日期选择器，并且你可能需要使用 58 行重复性压力诱发代码来在一个页面上获取日期选择器。一旦有人制作了一个合适的 ReactJS `<DatePicker />`函数，问题就解决了，只需要不到一行的代码就可以包含它，你可以在页面上包含零次、一次或多次。"即使。在。使用。Shim。到 Internet Exploder 8"是有意使用标点符号，正如特里·普拉切特在巨魔的讲话中所用的那样，并且是强调的。至于“Internet Exploder”这个称号已经存在很长时间，开发人员，或者至少是我，在实现一个可以在任何正常浏览器上工作的解决方案时遇到了两个问题，然后再次让事情运行起来，这次是为了那个，呃，派对的生活。

维基百科的目标是中立的“POV”（观点），并毫不畏缩地写道早期版本：

这个版本的 Internet Explorer 因其安全问题和对现代 Web 标准的支持不足而受到广泛批评，在“有史以来最糟糕的技术产品”列表中频繁出现，PC World 将其标记为“地球上最不安全的软件”[2]。甚至还没有提到所有的魔法，这意味着你不必管理![从这里开始的下一步](img/B04108_12_06.jpg)转换，因为你在概念上会将一切都毁掉，并在特定时间点重建事物。

有很多可能性可以探索，也许有一件事要说：

当这本书开始时，作者的家是 Python。当这本书结束时，作者的家是 ReactJS。
