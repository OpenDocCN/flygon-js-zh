# 第二章：原始数据类型、数组、循环和条件

在深入研究 JavaScript 的面向对象特性之前，让我们首先看一些基础知识。本章将介绍以下主题：

+   JavaScript 中的原始数据类型，如字符串和数字

+   数组

+   常见运算符，如`+`、`-`、`delete`和`typeof`

+   流程控制语句，如循环和`if...else`条件

# 变量

变量用于存储数据；它们是具体值的占位符。编写程序时，使用变量而不是实际数据更方便，因为写`pi`比写`3.141592653589793`要容易得多；特别是当它在程序中多次出现时。存储在变量中的数据可以在最初分配后进行更改，因此称为**变量**。您还可以使用变量存储在编写代码时对您未知的数据，例如稍后操作的结果。

使用变量需要以下两个步骤。您需要：

+   声明变量

+   初始化它，即给它一个值

要声明变量，您将使用`var`语句，如下面的代码片段：

[PRE0]

对于变量的名称，可以使用字母、数字、下划线字符和美元符号的任何组合。但是，不能以数字开头，这意味着以下代码声明无效：

[PRE1]

初始化变量意味着为第一次（初始）赋予它一个值。以下是两种方法：

+   首先声明变量，然后初始化它

+   声明并用单个语句初始化它

后者的示例如下：

[PRE2]

现在名为`a`的变量包含值`1`。

您可以使用单个`var`语句声明，并可选择初始化多个变量；只需用逗号分隔声明，如下行代码所示：

[PRE3]

为了可读性，通常使用每行一个变量来编写，如下所示：

[PRE4]

### 注意

变量名称中的$字符

您可能会看到变量名称中使用美元符号字符（`$`），如`$myvar`或不太常见的`my$var`。变量名称中允许此字符出现在任何位置，尽管以前的 ECMA 标准版本不鼓励在手写程序中使用它，并建议它只能在生成的代码（由其他程序编写的程序）中使用。JavaScript 社区并不太尊重这个建议，实际上$在实践中常用作函数名。

## 变量区分大小写

变量名称区分大小写。您可以轻松通过 JavaScript 控制台验证此语句。尝试按下每行后的*Enter*键输入以下代码：

[PRE5]

在输入第三行时，为了节省按键次数，您可以输入`case`并按*Tab*或右箭头键。**Console**会自动将变量名补全为`case_matters`。类似地，对于最后一行，输入`CASE`并按*Tab*键。最终结果如下图所示：

![变量区分大小写](img/image_02_001-e1482738938732.jpg)

在本书的其余部分，只提供示例的代码，而不是屏幕截图，如下所示：

[PRE6]

大于号（`>`）显示您键入的代码；其余部分是**Console**中打印的结果。再次提醒，当您看到这样的代码示例时，强烈建议您自己键入代码。然后，您可以通过稍微调整代码来进行实验，以更好地了解其工作原理。

### 注意

你可以在前面的截图中看到，有时你在**控制台**中输入的内容会导致**undefined**这个词。你可以简单地忽略它，但如果你好奇的话，当评估（执行）你输入的内容时，**控制台**会打印返回的值。一些表达式，比如`var a = 1;`，不会显式地返回任何东西，在这种情况下，它们会隐式地返回特殊值**undefined**（稍后会详细介绍）。当一个表达式返回某个值（例如，前面例子中的`case_matters`或类似`1 + 1`的东西）时，结果值会被打印出来。并非所有的控制台都会打印**undefined**值；例如，Firebug 控制台。

# 运算符

运算符接受一个或两个值（或变量），执行一个操作，并返回一个值。让我们看一个使用运算符的简单例子，以澄清术语：

[PRE7]

在上面的代码中：

+   `+`符号是运算符

+   操作是加法

+   输入值是`1`和`2`（它们也被称为操作数）

+   结果值是`3`

+   整个东西被称为表达式

不要直接在表达式中使用值`1`和`2`，你可以使用变量。你也可以使用一个变量来存储操作的结果，如下面的例子所示：

[PRE8]

以下表格列出了基本的算术运算符：

| **运算符符号** | **操作** | **示例** |
| --- | --- | --- |
| `+` | 加法 |

[PRE9]

|

| `-` | 减法 |
| --- | --- |

[PRE10]

|

| `*` | 乘法 |
| --- | --- |

[PRE11]

|

| `/` | 除法 |
| --- | --- |

[PRE12]

|

| `%` | 取模，除法的余数 |
| --- | --- |

[PRE13]

有时候测试一个数字是偶数还是奇数是很有用的。使用取模运算符，很容易做到这一点。所有奇数被 2 整除时返回`1`，而所有偶数返回`0`，例如：

[PRE14]

|

| `++` | 将值增加`1` | 后增加是指在返回之后增加输入值，例如：

[PRE15]

相反的是前增加。输入值首先增加`1`，然后返回，例如：

[PRE16]

|

| `--` | 将值减 1 | 后减：

[PRE17]

前减：

[PRE18]

|

`var a = 1;`也是一个操作；它是简单的赋值操作，`=`是**简单赋值运算符**。

还有一类运算符，它们是赋值和算术运算符的组合。这些被称为**复合运算符**。它们可以使你的代码更加简洁。让我们看一些例子：

[PRE19]

在这个例子中，`a += 3;`只是`a = a + 3;`的一种更简洁的方式。例如：

[PRE20]

在这里，`a -= 3;`和`a = a - 3;`是一样的：

[PRE21]

除了之前讨论的算术和赋值运算符之外，还有其他类型的运算符，你将在本章和下一章中看到。

### 注意

**最佳实践**

始终用分号结束你的表达式。JavaScript 有一个分号插入机制，如果你忘记在行尾加上分号，它会自动添加分号。然而，这也可能是一个错误的来源，所以最好确保你总是明确地声明你想要结束表达式的地方。换句话说，`> 1 + 1`和`> 1 + 1;`都可以工作；但在整本书中，你总是会看到第二种类型，以分号结束，只是为了强调这个习惯。

# 基本数据类型

你使用的任何值都是某种类型的。在 JavaScript 中，以下是一些基本的数据类型：

1.  **数字**：这包括浮点数和整数。例如，这些值都是数字-`1`，`100`，`3`.`14`。

1.  **字符串**：这些由任意数量的字符组成，例如，`a`，`one`和`one 2 three`。

1.  **布尔**：这可以是`true`或`false`。

1.  **未定义**：当你尝试访问一个不存在的变量时，你会得到特殊值未定义。当你声明一个变量但尚未给它赋值时，也会发生同样的情况。JavaScript 在幕后用值`undefined`初始化变量。未定义数据类型只能有一个值-特殊值`undefined`。

1.  **Null**：这是另一种特殊的数据类型，只能有一个值-`null`值。它表示没有值，空值或无。与未定义的区别在于，如果变量具有空值，则仍然已定义；只是它的值恰好是空的。您很快就会看到一些例子。

不属于这里列出的五种原始类型之一的任何值都是对象。甚至 null 也被认为是对象，这有点尴尬，有一个（东西）实际上是什么都没有的对象。我们将在第四章*对象*中了解更多关于对象的知识，但目前，只需记住在 JavaScript 中，数据类型如下：

+   原始（先前列出的五种类型）

+   非原始（对象）

## 查找值类型-typeof 运算符

如果您想知道变量或值的类型，可以使用特殊的`typeof`运算符。此运算符返回表示数据类型的字符串。使用`typeof`的返回值是以下之一：

+   数字

+   字符串

+   布尔值

+   未定义

+   对象

+   函数

在接下来的几节中，您将看到`typeof`在使用每种五种原始数据类型的示例中的作用。

## 数字

最简单的数字是整数。如果将`1`分配给变量，然后使用`typeof`运算符，它将返回字符串`number`，如下所示：

[PRE22]

在前面的示例中，您可以看到第二次设置变量值时，不需要`var`语句。

数字也可以是浮点数（小数），例如：

[PRE23]

您可以直接在值上调用`typeof`，而无需首先将其分配给变量，例如：

[PRE24]

### 八进制和十六进制数

当数字以`0`开头时，它被视为八进制数。例如，八进制`0377`是十进制`255`：

[PRE25]

前面示例中的最后一行打印了八进制值的十进制表示。

ES6 提供了一个前缀`0o`（或`0O`，但在大多数等宽字体中看起来非常令人困惑）来表示八进制。例如，考虑以下代码行：

[PRE26]

虽然您可能不太熟悉八进制数，但您可能已经在 CSS 样式表中使用十六进制值来定义颜色。

在 CSS 中，您有几种选项来定义颜色，其中两种如下：

+   使用十进制值来指定 R（红色）、G（绿色）和 B（蓝色）的数量，范围从`0`到`255`。例如，*rgb(0, 0, 0)*是黑色，*rgb(255, 0, 0)*是红色（红色的最大量，没有绿色或蓝色）。

+   使用十六进制并为每个 R、G 和 B 值指定两个字符。例如，*#000000*是黑色，*#ff0000*是红色。这是因为*ff*是`255`的十六进制值。

在 JavaScript 中，您可以在十六进制值之前加上`0x`，也称为十六进制，例如：

[PRE27]

### 二进制文字

直到 ES6，如果您需要整数的二进制表示，您必须将它们作为字符串传递给`parseInt()`函数，基数为`2`，如下所示：

[PRE28]

在 ES6 中，您可以使用`0b`（或`0B`）前缀表示二进制整数。例如：

[PRE29]

### 指数文字

`1e1`（也写作`1e+1`或`1E1`或`1E+1`）表示数字 1 后面跟着一个 0，换句话说，是`10`。同样，`2e+3`表示数字 2 后面跟着三个 0，或者`2000`，例如：

[PRE30]

`2e+3`表示将数字**2**的小数点向右移动三位。还有`2e-3`，意思是将数字**2**的小数点向左移动三位。看一下下面的图：

![指数文字](img/image_02_002.jpg)

以下是代码：

[PRE31]

### 无穷大

JavaScript 中有一个称为 Infinity 的特殊值。它表示 JavaScript 无法处理的数字太大。Infinity 确实是一个数字，因为在控制台中键入`typeof Infinity`将确认。您还可以快速检查具有`308`个零的数字是否正常，但`309`个零太多。准确地说，JavaScript 可以处理的最大数字是`1.7976931348623157e+308`，而最小数字是`5e-324`，请看下面的示例：

[PRE32]

除以零会得到无穷大，例如：

[PRE33]

`Infinity`是最大的数（或者比最大的数稍微大一点），但最小的数呢？它是带有负号的无穷大；`-Infinity`，例如：

[PRE34]

这是否意味着你可以有一个正好是无穷大两倍的东西，从 0 到无穷大，然后从 0 到负无穷大？嗯，并不是真的。当你把`Infinity`和`-Infinity`相加时，你得到的不是`0`，而是一个被称为**Not a Number**（**NaN**）的东西，例如：

[PRE35]

任何其他算术运算中的`Infinity`作为操作数之一都会得到`Infinity`，例如：

[PRE36]

有一个不太为人知的全局方法`isFinite()`，它告诉你值是否是无穷大。ES6 添加了一个`Number.isFinite()`方法来做到这一点。你可能会问为什么还需要另一个方法。全局的`isFinite()`方法试图通过 Number(value)来转换值，而`Number.isFinite()`不会，因此它更准确。

### NaN

在前面的例子中，这个`NaN`是什么？原来，尽管它的名字是 Not a Number，`NaN`是一个特殊的值，也是一个数字：

[PRE37]

当你尝试执行假定数字的操作，但操作失败时，你会得到`NaN`。例如，如果你尝试将`10`乘以字符`"f"`，结果是`NaN`，因为`"f"`显然不是乘法的有效操作数：

[PRE38]

`NaN`是具有传染性的，所以如果你的算术运算中有一个`NaN`，整个结果都会泡汤，例如：

[PRE39]

#### Number.isNaN

ES5 有一个全局方法-`isNaN()`。它确定一个值是否是`NaN`。ES6 提供了一个非常相似的方法-`Number.isNaN()`（请注意，这个方法不是全局的）。

全局`isNaN()`和`Number.isNaN()`之间的区别在于，全局`isNaN()`在评估之前会转换非数字值为`NaN`。让我们看下面的例子。我们使用 ES6 的`Number.isNaN()`方法来测试某个值是否是`NaN`：

[PRE40]

我们看到 ES5 的全局`isNaN()`方法首先转换非数字值，然后进行比较；其结果与 ES6 的对应方法不同：

[PRE41]

总的来说，与其全局变量相比，`Number.isNaN()`更正确。然而，它们都不能用来判断某个值是否不是一个数字-它们只是回答这个值是否是`NaN`。实际上，你更感兴趣的是知道一个值是否被识别为一个数字。Mozilla 建议使用以下 polyfill 方法来做到这一点：

[PRE42]

#### Number.isInteger

这是 ES6 中的一个新方法。如果数字是有限的并且不包含任何小数点（是一个整数），它返回`true`：

[PRE43]

## 字符串

字符串是用来表示文本的字符序列。在 JavaScript 中，放在单引号或双引号之间的任何值都被视为字符串。这意味着`1`是一个数字，但`"1"`是一个字符串。当与字符串一起使用时，`typeof`返回字符串`"string"`，例如：

[PRE44]

这是一个在字符串上下文中使用的数字的例子：

[PRE45]

如果你在引号中什么都不放，它仍然是一个字符串（一个空字符串），例如：

[PRE46]

正如你已经知道的，当你用加号和两个数字一起使用时，这是算术加法运算。然而，如果你用加号和字符串一起使用，这是一个字符串连接操作，并且返回两个字符串粘在一起：

[PRE47]

`+`运算符的双重用途是错误的根源。因此，如果你打算连接字符串，最好确保所有的操作数都是字符串。加法也是一样；如果你打算加上数字，那么确保操作数是数字。你将在本章和本书的后面学到各种方法来做到这一点。

### 字符串转换

当你使用类似数字的字符串，例如，`"1"`，作为算术运算中的操作数时，字符串在幕后被转换为数字。这对所有算术运算都有效，除了加法，因为它存在歧义。考虑以下例子：

[PRE48]

将任何类似数字的字符串转换为数字的一种懒惰方法是将其乘以`1`（另一种方法是使用一个名为`parseInt()`的函数，您将在下一章中看到）：

[PRE49]

如果转换失败，您将得到`NaN`：

[PRE50]

您可以通过将其乘以`1`将字符串转换为数字。相反-将任何东西转换为字符串-可以通过与空字符串连接来完成，如下所示：

[PRE51]

### 特殊字符串

还有一些具有特殊含义的字符串，如下表所示：

| **String** | **Meaning** | **Example** |
| --- | --- | --- |

| `\\``'``"` | `\`是转义字符。当您想在字符串中使用引号时，您可以转义它们，以便 JavaScript 不认为它们意味着字符串的结束。如果您想在字符串中有一个实际的反斜杠，请用另一个反斜杠转义它。| `> var s = 'I don't know';`: 这是一个错误，因为 JavaScript 认为字符串是`I don`，其余是无效的代码。以下代码是有效的：

[PRE52]

|

| `\n` | 行尾。 |
| --- | --- |

[PRE53]

|

| `\r` | 回车。|考虑以下陈述：

[PRE54]

所有这些的结果如下：

[PRE55]

|

| `\t` | 制表符。 |
| --- | --- |

[PRE56]

|

| `\u` | `\u`后跟字符代码，允许您使用 Unicode。|以下是我的保加利亚名字，用西里尔字母写成：

[PRE57]

|

还有一些很少使用的其他字符：`\b`（退格）、`\v`（垂直制表符）和`\f`（换页符）。

### 字符串模板文字

ES6 引入了模板文字。如果您熟悉其他编程语言，Perl 和 Python 现在已经支持模板文字一段时间了。模板文字允许在常规字符串中嵌入表达式。ES6 有两种文字：模板文字和标记文字。

模板文字是带有嵌入表达式的单行或多行字符串。例如，您一定做过类似的事情：

[PRE58]

您也可以使用模板文字来实现相同的效果，如下所示：

[PRE59]

模板文字用反引号（`` ` ``）（重音符）字符，而不是通常的双引号或单引号。模板文字占位符由美元符号和花括号（`${expression}`）表示。默认情况下，它们被连接在一起形成一个字符串。以下示例显示了一个带有稍微复杂的表达式的模板文本:

[PRE60]

[PRE151]

首先尝试将`v`设置为`100`，`0`或`null`进行实验。

1.  编写一个打印乘法表的小程序。提示：在另一个循环内嵌套使用循环。

# 总结

在本章中，你学到了关于 JavaScript 程序的基本构建块。现在你知道以下原始数据类型：

+   数字

+   字符串

+   布尔值

+   未定义

+   空

你也知道了相当多的运算符，它们如下：

+   **算术运算符**：`+`，`-`，`*`，`/`和`%`

+   **递增运算符**：`++`和`-`

+   **赋值运算符**：`=`，`+=`，`-=`，`*=`，`/=`和`%=` 

+   **特殊运算符**：`typeof`和`delete`

+   **逻辑运算符**：`&&`，`||`和`!`

+   **比较运算符**：`==`，`===`，`!=`，`!==`，`<`，`>`，`>=`和`<=`

+   **三元运算符**：`?`

然后你学会了如何使用数组来存储和访问数据，最后你看到了使用条件（`if...else`或`switch`）和循环（`while`，`do...while`，`for`和`for...in`）来控制程序流程的不同方法。

这是相当多的信息；在深入下一章之前，给自己一个当之无愧的鼓励。更有趣的内容即将到来！
